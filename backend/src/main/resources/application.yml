server:
  port: ${PORT:8080}

spring:
  application:
    name: spring-ai

  # Cấu hình MongoDB
  data:
    mongodb:
      uri: ${MONGODB_URI}

  # Tắt auto-config Security
  autoconfigure:
    exclude: org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration

  # ==========================================
  # CẤU HÌNH EMAIL (ĐÃ SỬA ĐỔI)
  # ==========================================
  mail:
    host: smtp.gmail.com
    port: 587
    username: ${MAIL_USERNAME}
    password: ${MAIL_PASSWORD}
    properties:
      mail:
        transport:
          protocol: smtp
        smtp:
          auth: true
          starttls:
            enable: true
            required: true
          # Quan trọng: Tăng timeout và connection timeout
          connectiontimeout: 10000
          timeout: 10000
          writetimeout: 10000
          # Quan trọng: Trust all certificates (Đôi khi SSL handshake bị lỗi trên Cloud)
          ssl:
            trust: "*"
            checkserveridentity: false
    # Thử nghiệm: Protocol nên để trống hoặc là smtp, không phải smtps cho cổng 587
    protocol: smtp

  # Cấu hình RabbitMQ
  rabbitmq:
    uri: ${RABBITMQ_URI}

  # Cấu hình Spring AI
  ai:
    openai:
      api-key: ${GEMINI_API_KEY}
      chat:
        base-url: https://generativelanguage.googleapis.com
        completions-path: /v1beta/openai/chat/completions
        options:
          model: gemini-2.0-flash

# ==============================
# Custom Configurations
# ==============================

# JWT configuration
jwt:
  secret: ${JWT_SECRET}
  expiration: 86400000

# RabbitMQ custom configuration
rabbitmq:
  exchange: notification.exchange
  routing-key: notification.routing.key

# Cloudinary Config
cloudinary:
  cloud_name: ${CLOUDINARY_CLOUD_NAME}
  api_key: ${CLOUDINARY_API_KEY}
  api_secret: ${CLOUDINARY_API_SECRET}

# Logging levels
logging:
  level:
    org:
      springframework:
        mail: DEBUG
        amqp: DEBUG
      eclipse:
        angus:
          mail: DEBUG
    com:
      rabbitmq: DEBUG